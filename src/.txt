<script setup lang="ts">
import { reactive } from 'vue';
import { useThemeStore } from '@/stores/ThemeStore';
import { useRouter } from 'vue-router'; 

import RegisterComponent  from '@/components/auth/RegisterComponent.vue'
import LoginComponent  from '@/components/auth/LoginComponent.vue'

const router = useRouter();  // Obtener el router
const themeStore = useThemeStore();
const theme = reactive(themeStore);

//Estado para el form
const formState = reactive({
  isLogin: true, // Controla si estamos en el formulario de login (true) o registro (false)
  email: "",
  password: "",
  name: "", // Usado solo en el formulario de registro
  confirmPassword: "", // Usado solo en el formulario de registro
});

// Maneja el submit del formulario
function handleSubmit() {
  // Si estamos en login, simplemente muestra un alert
  if (formState.isLogin) {
    alert("Inicio de sesión exitoso");
    router.push('/tasks'); // Redirige al Home si el login es exitoso

  } else {
    // Si estamos en registro, muestra un alert para registro
    alert("Registro enviado");
  }
}

// Método para alternar entre login y registro
function toggleForm() {
  formState.isLogin = !formState.isLogin;
}

</script>

<template>
  <div class="min-h-screen flex flex-col items-center justify-center bg-gray-100 dark:bg-gray-800 p-6">
    <div :class="theme.darkMode ? 'bg-white/[0.12]' : 'bg-blue-900/20'" class="w-full max-w-md bg-white dark:bg-gray-700 rounded-lg shadow-md p-6">
      
      <!-- Renderizado condicional entre LoginComponent y RegisterComponent -->
      <component
        :is="formState.isLogin ? LoginComponent : RegisterComponent"
        :email="formState.email"
        :password="formState.password"
        :name="formState.name"
        :confirm-password="formState.confirmPassword"
        @submit="handleSubmit"
      />
      
      <!-- Botón para alternar entre Login y Registro -->
      <button 
        @click="toggleForm" 
        :class="theme.darkMode ? 'text-white-100' : 'text-blue-500'"
        class="w-full mt-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
        
        <!-- Texto del botón que cambia según el estado -->
        {{ formState.isLogin ? '¿No tienes cuenta? Regístrate' : '¿Ya tienes cuenta? Inicia sesión' }}
      </button>
    </div>
  </div>
</template>

<style scoped></style>